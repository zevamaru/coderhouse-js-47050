<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1 id="clima">-</h1>
    <button id="btnClima">Consultar clima</button>
    <button id="btnOtraFuncionalidad">Otra funcionalidad</button>

    <p>
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Unde sunt error similique? Odit
      dolore hic quasi iusto quibusdam ipsam nihil nobis, ab incidunt est facilis, dolor modi
      voluptatum praesentium eligendi nemo reiciendis tempore! Ut itaque deleniti neque doloribus
      minus, alias esse recusandae ullam veniam reiciendis consectetur quaerat eaque laborum optio
      nihil dolorem iste quis molestiae ad mollitia sunt at. Ad esse voluptatibus similique enim,
      atque officiis sint, veritatis facere laudantium tempore aperiam qui eaque, obcaecati illo
      voluptatem necessitatibus! Omnis, tempora ducimus. Magnam dolorem quaerat, nisi aliquam est,
      quae aperiam facere mollitia voluptatibus a qui expedita vitae, repellat maiores omnis quasi!
    </p>

    <script>
      const btnClima = document.querySelector("#btnClima");
      const btnOtraFuncionalidad = document.querySelector("#btnOtraFuncionalidad");
      const elementoClima = document.querySelector("#clima");

      btnClima.addEventListener("click", function () {
        //const promesa = consultarClima();
        consultarClima()
          // La promesa se ejecutó existosamente
          .then((resultado) => {
            console.log("La conexión fue exitosa: " + resultado);
            elementoClima.innerText = resultado;
          })
          // Hubo un error y no se pudo concretar
          .catch((error) => {
            console.log("Hubo un error: " + error);
          })
          // Que se ejecuta siempre al finalizar la promesa (sin importar si salió bien o mal)
          .finally(() => {
            console.log("Promesa finalizada.");
            elementoClima.style.border = "5px solid red";
          });
      });
      btnOtraFuncionalidad.addEventListener("click", function () {
        alert("Esto está simulando otra funcionalidad.");
      });

      // Simula conectar a un servidor externo para consultar el clima
      function consultarClima() {
        //const promesa = new Promise((resuelta, rechazada) => {
        return new Promise((resuelta, rechazada) => {
          console.log("Conectando con el servidor del clima...");
          const delayConexion = 5000;
          setTimeout(() => {
            resuelta("24° Soleado");
            ////rechazada("Hubo un error de conexión");
          }, delayConexion);
        });
        //return promesa;
      }
    </script>
  </body>
</html>
